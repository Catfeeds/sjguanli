<include file='public:header' />
<script src="__PUBLIC__/js/uploadify/ajaxfileupload.js"></script>
<script src="__PUBLIC__/js/my97/WdatePicker.js"></script>
<!-- <div class="sjgl_lead">
    <ul>
        <li><a href="#">商家管理</a> > <a href="">商城</a> > <a>发布商品</a></li>
    </ul>
</div>
<div class="tuan_content">
    <div class="radius5 tuan_top">
        <div class="tuan_top_t">
            <div class="left tuan_topser_l">商家发布的商品要在后台审核之后才能显示在前台</div>
        </div>
    </div> 
    <div class="tabnr_change  show">
    	<form method="post"  action="<{:U('goods/create')}>"  target="baocms_frm">
        <js file='__PUBLIC__/js/uploadify/jquery.uploadify.min.js'/>
        <link rel="stylesheet" href="__PUBLIC__/js/uploadify/uploadify.css">
    	<table class="tuanfabu_table" width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
                <td width="120"><p class="tuanfabu_t">商品名称：</p></td>
                <td><div class="tuanfabu_nr">
                <input type="text" name="data[title]" value="<{$detail.title|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                </div></td>
            </tr>
             <tr>
                    <td width="120"><p class="tuanfabu_t">商品简介：</p></td>
                    <td><div class="tuanfabu_nr">
                            <input type="text" name="data[intro]" value="<{$detail.intro|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                        </div></td>
                </tr>
                <tr>
                    <td width="120"><p class="tuanfabu_t">产品规格：</p></td>
                    <td><div class="tuanfabu_nr">
                           <input type="text" name="data[guige]" value="<{$detail.guige|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                        </div></td>
                         </tr>
                          <tr>
                    <td width="120"><p class="tuanfabu_t">库存：</p></td>
                    <td><div class="tuanfabu_nr">
                           <input type="text" name="data[num]" value="<{$detail.num|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                        </div></td>
                         </tr>
            <tr>
                    <td width="120"><p class="tuanfabu_t">分类：</p></td>
                    <td><div class="tuanfabu_nr">
                            <select name="parent_id" id="parent_id" class="seleFl w100" style="display: inline-block; margin-right: 10px;">
                            <option value="0">请选择...</option>
                            <foreach name="cates" item="var">
                                <eq name="var.parent_id" value="0">
                                <option value="<{$var.cate_id}>"><{$var.cate_name}></option>
                                </eq>
                            </foreach>
                        </select>
                        <select id="cate_id" name="data[cate_id]" class="seleFl w100" style="display: inline-block;">

                        </select>
                        <script>
                            $(document).ready(function (e) {
                                $("#parent_id").change(function () {
                                    var url = '<{:U("admin/goodscate/child",array("parent_id"=>"0000"))}>';
                                    if ($(this).val() > 0) {
                                        var url2 = url.replace('0000', $(this).val());
                                        $.get(url2, function (data) {
                                            $("#cate_id").html(data);
                                        }, 'html');
                                    }
                                });

                            });
                        </script>
                        </div></td>
                </tr>
                   <tr>
                    <td width="120"></td>
                    <td id="jq_setting">


                    </td>
                </tr>
                <script>
                    var ajaxurl = '<{:U("admin/goodscate/ajax",array("cate_id"=>"0000"))}>';
                    $(document).ready(function () {
                        $("#cate_id").change(function () {
                            if ($(this).val() > 0) {
                                var link = ajaxurl.replace('0000', $(this).val());
                                $.get(link, function (data) {
                                    $("#jq_setting").html(data);
                                }, 'html');

                            } else {
                                alert("请选择分类");
                            }
                        });
                    });
                </script>
            <tr>
                <td width="120"><p class="tuanfabu_t">商家分类：</p></td>
                <td><div class="tuanfabu_nr">
                <select id="shopcate_id" name="data[shopcate_id]" class="manageSelect w200" style="width: 140px;">
                <foreach name="autocates" item="var">
                <option value="<{$var.cate_id}>"  <eq name="var.cate_id" value="$detail.cate_id">selected="selected"</eq> ><{$var.cate_name}></option>
                </foreach>
                </select>
                </div></td>
            </tr>
            <tr>
                <td><p class="tuanfabu_t">商品图片：</p></td>
                <td><div class="tuanfabu_nr">
                <div style="width: 300px;height: 100px; float: left;">
                    <input type="hidden" name="data[photo]" value="<{$detail.photo}>" id="data_photo" />
                    <input id="photo_file" name="photo_file" type="file" multiple="true" value="" />
                </div>
                <div style="width: 300px;height: 100px; float: left;">
                    <img id="photo_img" width="80" height="80"  src="__ROOT__/attachs/<{$detail.photo|default='default.jpg'}>" />
                    建议尺寸<{$CONFIG.attachs.goods.thumb}>
                </div>
                <script>
                    $("#photo_file").uploadify({
                        'swf': '__PUBLIC__/js/uploadify/uploadify.swf?t=<{$nowtime}>',
                        'uploader': '<{:U("app/upload/uploadify",array("model"=>"goods"))}>',
                        'cancelImg': '__PUBLIC__/js/uploadify/uploadify-cancel.png',
                        'buttonText': '上传商品图片',
                        'fileTypeExts': '*.gif;*.jpg;*.png',
                        'queueSizeLimit': 1,
                        'onUploadSuccess': function (file, data, response) {
                            $("#data_photo").val(data);
                            $("#photo_img").attr('src', '__ROOT__/attachs/' + data).show();
                        }
                    });
                </script>
                </div>
                </td>
            </tr>
             <tr>
                    <td><p class="tuanfabu_t">更多详情图：</p></td>
                    <td class="rgTdBt">
                        <div class="tuanfabu_nr">
                            <div>
                                  <input id="logo_file" name="logo_file" type="file" multiple="true" value="" />
                            </div>
                            <div class="jq_uploads_img">
                                <foreach  name="thumb" item="item">
                                    <span style="width: 200px; height: 120px; float: left; margin-left: 5px; margin-top: 10px;">
                                       <img width="100" height="100" src="__ROOT__/attachs/<{$item.photo}>">

                                        <input type="hidden" name="photos[]" value="<{$item.photo}>" />
                                        <a href="javascript:void(0);">取消</a>
                                    </span>
                                </foreach>
                            </div>
                        </div>
                        <script>

                                $("#logo_file").uploadify({

                                    'swf': '__PUBLIC__/js/uploadify/uploadify.swf?t=<{$nowtime}>',

                                    'uploader': '<{:U("app/upload/uploadify",array("model"=>"goodspic"))}>',

                                    'cancelImg': '__PUBLIC__/js/uploadify/uploadify-cancel.png',

                                    'buttonText': '上传图片',

                                    'fileTypeExts': '*.gif;*.jpg;*.png',

                                    'queueSizeLimit': 10,

                                    'onUploadSuccess': function (file, data, response) {

                                        var str = '<span style="width: 200px; height: 120px; float: left; margin-left: 5px; margin-top: 10px;">  <img width="200" height="100" src="__ROOT__/attachs/' + data + '">  <input type="hidden" name="photos[]" value="' + data + '" />    <a href="javascript:void(0);">取消</a>  </span>';

                                        $(".jq_uploads_img").append(str);

                                    }

                                });



                                $(document).on("click", ".jq_uploads_img a", function () {

                                    $(this).parent().remove();

                                });





                            </script>
                    </td>
                </tr>
                 <tr>
                    <td width="120"><p class="tuanfabu_t">属性：</p></td>
                    <td><div class="tuanfabu_nr">
                             <label><span>认证商家：</span><input type="checkbox" name="data[is_vs1]" value="1" /></label>
                        <label><span style="margin-left: 20px;">正品保证：</span><input type="checkbox" name="data[is_vs2]" value="1" /></label>
                        <label><span style="margin-left: 20px;">假一赔十：</span><input type="checkbox" name="data[is_vs3]" value="1" /></label>
                        <label><span style="margin-left: 20px;">当日送达：</span><input type="checkbox" name="data[is_vs4]" value="1" /></label>
                        <label><span style="margin-left: 20px;">免运费：</span><input type="checkbox" name="data[is_vs5]" value="1" /></label>
                        <label><span style="margin-left: 20px;">货到付款</span><input type="checkbox" name="data[is_vs6]" value="1" /></label>

                        </div></td>
                </tr>
            <tr>
                <td width="120"><p class="tuanfabu_t">市场价格：</p></td>
                <td><div class="tuanfabu_nr">
                <input type="text" name="data[price]" value="<{$detail.price|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                </div></td>
            </tr>
            <tr>
                <td width="120"><p class="tuanfabu_t">商城价格：</p></td>
                <td><div class="tuanfabu_nr">
                <input type="text" name="data[mall_price]" value="<{$detail.mall_price|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                </div></td>
            </tr>
            <tr>
                <td width="120"><p class="tuanfabu_t">可使用积分数：</p></td>
                <td><div class="tuanfabu_nr">
                <input type="text" name="data[use_integral]" value="<{$detail.use_integral|default=''}>" class="tuanfabu_int tuanfabu_intw2" />
                <code>最大可使用的积分数，100积分抵扣1元，不填表示不可使用积分</code>
                </div>
                </td>
            </tr>

            <tr>
                <td><p class="tuanfabu_t">购买须知：</p></td>
                <td><div class="tuanfabu_nr">
                <script type="text/plain" id="data_instructions" name="data[instructions]" style="width:800px;height:360px;"><{$detail.instructions}></script>
                <link rel="stylesheet" href="__PUBLIC__/umeditor/themes/default/css/umeditor.min.css" type="text/css">
				<script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor/umeditor.config.js"></script>
                <script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor/umeditor.min.js"></script>
                <script type="text/javascript" src="__PUBLIC__/umeditor/lang/zh-cn/zh-cn.js"></script>
                <script>
                                um = UM.getEditor('data_instructions', {
                                    imageUrl: "<{:U('app/upload/editor')}>",
                                    imagePath: '__ROOT__/attachs/editor/',
                                    lang: 'zh-cn',
                                    langPath: UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
                                    focus: false
                                });
                </script>
                </div></td>
            </tr>
            <tr>
                <td><p class="tuanfabu_t">商品详情：</p></td>
                <td><div class="tuanfabu_nr">
                <script type="text/plain" id="data_details" name="data[details]" style="width:800px;height:360px;"><{$detail.details}></script>
                <script>
					um = UM.getEditor('data_details', {
						imageUrl: "<{:U('app/upload/editor')}>",
						imagePath: '__ROOT__/attachs/editor/',
						lang: 'zh-cn',
						langPath: UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
						focus: false
					});
				</script>
                </div></td>
            </tr>
            <tr>
                <td width="120"><p class="tuanfabu_t">过期时间：</p></td>
                <td><div class="tuanfabu_nr">
                <input type="text" name="data[end_date]" value="<{$detail.end_date|default=''}>" onfocus="WdatePicker();" class="tuanfabu_int tuanfabu_intw2" />
                </div></td>
            </tr>
        </table>
        <div class="tuanfabu_an">
        <input type="submit" class="radius3 sjgl_an tuan_topbt" value="确认发布" />
        </div>
        </form>
    </div> 
</div> -->
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    i {
        font-style: normal;
    }

    .main {
        padding: 0 20px 140px 10px;
        min-width: 1340px;
    }

    input::-webkit-input-placeholder {
        color: #C8D5E0;
    }

    .main>div {
        overflow: hidden;
        margin-top: 42px;
    }

    .main>div select {
        width: 216px;
        height: 34px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
        position: relative;
    }
    .main>div .select{
        color: #C8D5E0;
    }
    .main>div select option {
        color: #304B5D;
    }

    .title {
        background: #EDF3F8;
        border-radius: 3px;
        line-height: 40px;
        margin-top: 32px;
        padding-left: 16px;
        font-size: 16px;
    }

    .left {
        float: left;
        width: 146px;
        text-align: right;
        line-height: 32px;
        margin-right: 10px;
    }

    .left i {
        display: inline-block;
        color: red;
        font-style: normal;
        font-weight: 600;
        font-size: 16px;
        transform: translateY(4px);
    }

    input {
        height: 34px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
        padding-left: 10px;
        vertical-align: middle;
    }

    .name input {
        width: 472px;
    }

    .tip {
        color: #A4B4C4;
        margin-left: 10px;
        line-height: 34px;
    }

    label {
        position: relative;
        transform: translateY(1px);
        margin: 0 16px 0 4px;
    }

    .thumbnail {
        position: relative;
    }

    .thumbnail input {
        border: none;
        float: left;
        width: 96px;
        height: 96px;
        position: relative;
        z-index: 4;
        opacity: 0;
        cursor: pointer;
    }

    .file {
        position: absolute;
        width: 96px;
        height: 96px;
        top: 0;
        background: #ECF3F8;
        border-radius: 3px;
        left: 156px;
        font-size: 76px;
    }

    .file i {
        position: absolute;
        width: 30px;
        height: 30px;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        /* cursor: pointer; */
        background: url('__TMPL__statics/images/icon_shangchuan30x30.png') center/cover no-repeat;
    }

    .file img {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
    }

    .thumbnail .tip {
        line-height: 20px;
    }

    .banner .pic {
        float: left;
        margin-right: 8px;
        position: relative;
    }

    .banner input,
    .banner .pic div {
        width: 96px;
        height: 96px;
        background: #ECF3F8;
        border-radius: 3px;
        /* line-height: 85px; */
        /* color: #fff; */
        /* text-align: center; */
        cursor: pointer;
    }

    .banner .pic div {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        font-size: 76px;
    }

    .banner .pic input {
        position: relative;
        z-index: 4;
        opacity: 0;
    }

    .banner img {
        width: 96px;
        height: 96px;
        border-radius: 3px;
    }

    textarea {
        border: 1px solid #C8D5E0;
        border-radius: 3px;
        padding: 15px 10px;
        line-height: 20px;
    }

    textarea::-webkit-input-placeholder {
        color: #C8D5E0;
    }

    .price {
        border-bottom: 1px solid #C8D5E0;
        padding-bottom: 48px;
    }

    .price input,
    .num input {
        width: 96px;
        height: 34px;
        margin-right: 8px;
    }

    .cultivate div {
        position: relative;
        cursor: pointer;
    }

    .cultivate input {
        opacity: 0;
    }

    .cultivate div b,
    .penum b {
        position: absolute;
        width: 14px;
        height: 14px;
        left: 0;
        top: 9px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
    }

    .cultivate div .active {
        background: url('__TMPL__statics/images/icon_xuanzhong_sel14x14.png') center/cover no-repeat;
        border: 0;
    }

    .penum {
        cursor: pointer;
        position: relative;
    }

    .penum input {
        opacity: 0;
    }

    .penum b {
        top: 8px;
        left: 69px;
    }

    .penum .active {
        background: url('__TMPL__statics/images/icon_xuanzhong_sel14x14.png') center/cover no-repeat;
        border: 0;
    }

    .num input[type='checkbox'] {
        width: 14px;
        height: 14px;
        margin: 0 0 0 64px;
        position: relative;
        transform: translateY(-1px);
    }

    .penum {
        width: 206px;
        margin-right: 0;
    }

    .notice input {
        width: 210px;
        margin-right: 8px;
    }

    .phase span {
        float: left;
        width: 104px;
        line-height: 32px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
        text-align: center;
        margin-right: 8px;
        cursor: pointer;
        position: relative;
    }

    .phase .active {
        border: 1px solid #009CF5;
        border-radius: 3px;
        color: #009CF5;
    }

    .phase input {
        position: absolute;
        visibility: hidden;
    }

    .phase .active i {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 25px;
        height: 21px;
        background: url('__TMPL__statics/images/title_shixue25x21.png') center/cover no-repeat;
    }

    .ttop {
        transform: translateY(-10px);
    }

    input[type='radio'] {
        margin-right: 8px;
    }

    label {
        cursor: pointer;
    }

    .refund label {
        position: relative;
    }

    .refund label input {
        visibility: hidden;
    }

    .refund .active i {
        background: url('__TMPL__statics/images/icon_xuanzhong_sel14x14.png') center/cover no-repeat;
        border: 0;
    }

    .refund label i {
        position: absolute;
        width: 14px;
        height: 14px;
        left: 0;
        top: 3px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
    }

    .msg_phone input {
        width: 210px;
    }
    .msg_phone .num .area-code{
        width: 96px;
    }
    .msg_phone .num span{
        margin: 0 10px 0 5px;
        font-family: PingFangHK-Regular;
        font-size: 14px;
        color: #364A5E;
        letter-spacing: 0;
    }
    .msg_time input {
        width: 210px;
        height: 34px;
        border: 1px solid #C8D5E0;
        border-radius: 3px;
    }

    .main .address select {
        width: 112px;
        margin-right: 4px;
    }

    .main .address input {
        width: 418px;
    }

    .main .address .lat {
        width: 352px;
        margin: 24px 0 0 156px;
    }

    .main .address .btn {
        display: inline-block;
        width: 96px;
        line-height: 32px;
        border: 1px solid #C8D5E0;
        text-align: center;
        /* position: relative; */
        transform: translateY(13px);
        margin-left: 6px;
        cursor: pointer;
    }

    .limit {
        position: relative;
    }

    .limit div {
        position: absolute;
        bottom: 20px;
        right: 15px;
    }

    .address .tip {
        display: inline-block;
        transform: translateY(13px);
    }

    .fixed {
        position: fixed;
        bottom: 50px;
        right: 26px;
    }

    .fixed button {
        width: 128px;
        height: 40px;
        border-radius: 3px;
        text-align: center;
        cursor: pointer;
        margin-left: 10px;
    }

    .fixed .btn1 {
        color: #fff;
        border: 0;
        background: #0ECEAF;
        line-height: 40px;
    }

    .fixed .btn2 {
        border: 1px solid #C8D5E0;
        line-height: 38px;
        background: #fff;
    }

    .thumbnail .left,
    .banner .left {
        transform: translateY(-10px);
    }
</style>
<!-- <form class="main" method="post" target="baocms_frm"> -->
<form class="main">
    <div class="title">
        基本信息
    </div>

    <div class="name">
        <div class="left">
            <i>*</i>
            <span>资源单位名称：</span>
        </div>
        <input type="text">
        <span class="tip">(特殊字符除外:_ -* \ /,25个字以内)</span>
    </div>

    <div class="thumbnail">
        <div class="left">
            <i>*</i>
            <span>LOGO图：</span>
        </div>
        <div class="file">
            <i></i>
            <img src="" alt="" id="logo_img">
        </div>
        <input type="hidden" name="agreement" id="logo" value="" />
        <input type="file" ref="avatarInput" name="logo1" id="logo1" accept="image/jpg,image/jpeg,image/png">
        <div class="tip" style="float:left">
            <div>(支持上传.jpg、.jpeg、.png格式图片</div>
            <div>图片比例为4:3且大小不能超过1M)</div>
        </div>
        <script>
            $('#logo1').on('change', function () {
                if (judge("logo1") == false) return false;
                ajaxFileUploadsLogo1();
            });

            function ajaxFileUploadsLogo1() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'logo1', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        console.log(data)
                        $("#logo").val(data);
                        $("#logo_img").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#logo1').change(function (e) { //再次绑定
                    ajaxFileUploadsLogo1();
                })
                return false;
            }
        </script>
        <!-- <span class="tip">（<br></span> -->
    </div>
    <div class="banner">
        <div class="left">
            <i>*</i>
            <span>营业执照：</span>
        </div>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img src="" alt="" id="banner_img">
            </div>
            <input type="hidden" name="agreement" id="banne" value="" />
            <input type="file" ref="avatarInput" name="banner" id="banner" ccept="image/jpg,image/jpeg,image/png">
        </div>
        <!-- <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
            </div>
            <input type="file" ref="avatarInput" name="banner" accept="image/*">
        </div>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
            </div>
            <input type="file" ref="avatarInput" name="banner" accept="image/*">
        </div> -->
        <div class="tip" style="float:left">
            <div>(支持上传.jpg、.jpeg、.png格式图片</div>
            <div>图片比例为16:9且大小不能超过1M)</div>
        </div>
        <script>
            $('#banner').on('change', function () {
                if (judge("banner") == false) return false;
                ajaxFileUploadsBanner1();
            });

            function ajaxFileUploadsBanner1() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banner', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        console.log(data)
                        $("#banne").val(data);
                        $("#banner_img").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banner').change(function (e) { //再次绑定
                    ajaxFileUploadsBanner1();
                })
                return false;
            }
        </script>
    </div>

    <div class="title">
        联系方式
    </div>
    <div class="msg_phone">
        <div class="left">
            <span>资源单位电话：</span>
        </div>
        <div style="float:left" class="num">
            <input type="text" placeholder="区号" class="area-code"><span>-</span><input type="text" placeholder="座机号码">
        </div>
    </div>
    <div class="msg_time">
        <div class="left">
            <span>营业时间：</span>
        </div>
        <div style="float:left">
            <input type="text" class="radius3 tuan_topser" name="bg_date" value="" onfocus="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss'});"
            />
            <span class="wave">~</span>
            <input type="text" class="radius3 tuan_topser" name="end_date" value="" onfocus="WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm:ss'});"
            />
        </div>
    </div>
    <div class="address">
            <div class="left">
                <i>*</i>
                <span>基地地址：</span>
            </div>
            <select name="province" id="province" onchange="obtains(1)">
                <option value="0">省份</option>
                <foreach name="province" item="vp">
                    <option value="<{$vp.id}>"><{$vp.name}></option>
                </foreach>
            </select>
            <select name="city" id="city" onchange="obtains(2)">
                <option value="0">市级</option>
            </select>
            <select name="area" id="area">
                <option value="0">区/县</option>
            </select>
            <script>
                function obtains(u){
                    if(u == 1){
                        var id = $("#province").val();
                        if(id == 0){
                            $('#city').html('');
                            $('#area').html('');
                            $('#city').html('<option value="0">市级</option>');
                            $('#area').html('<option value="0">区/县</option>');
                        }
                    }else{
                        var id = $("#city").val();
                        if(id == 0){
                            $('#area').html('');
                            $('#area').html('<option value="0">区/县</option>');
                        }
                    }
    
                    $.ajax({
                        type: "POST", //提交方式
                        url: '<{:U("goods/obtains")}>', //路径
                        data: {"uid": id,"type":u}, //数据，这里使用的是Json格式进行传输
                        success: function (result) { //返回数据根据结果进行相应的处理
                            if(result.code == 1){
                                if(u == 1){
                                    $('#city').html('');
                                    $('#area').html('');
                                    $('#city').html(result.data);
                                    $('#area').html('<option value="0">区/县</option>');
                                }else if(u == 2){
                                    $('#area').html('');
                                    $('#area').html(result.data);
                                }
                            }
                        }
                    });
    
                }
            </script>
            <input type="text" placeholder="请填写详细地址">
            <br>
            <input class="lat" type="text" placeholder="点击按钮获取地址经纬度">
            <span class="btn">获取经纬度</span>
            <span class="tip">(例如：112.76859973；28.76564738)</span>
        </div>

    <div>
        <div class="left ttop">
            <i>*</i>
            <span>交通信息：</span>
        </div>
        <div class="example textarea2">
            <span class="limit" style="display:inline-block">
                <textarea name="traffic_information" id="" cols="72" style="resize:none" rows="5" 
                placeholder="例:：市内可乘坐158、66、112线路公交车、在世界之窗站下车即可。"
                maxlength="100" onchange="this.value=this.value.substring(0, 100)" onkeydown="this.value=this.value.substring(0, 100)" 
                onkeyup="this.value=this.value.substring(0, 100)"></textarea>
                <div class="">
                    <i>0</i>/
                    <span>100</span>
                </div>
            </span>
        </div>
    </div>
    <div class="title">
            资源单位联系人
    </div>
    <div class="msg_phone">
            <div class="left">
                <i>*</i>
                <span>联系人：</span>
            </div>
            <div class="num">
                <input type="text" placeholder="">
                <span class="tip">(默认资源单位管理员)</span>
            </div>
            <div style="overflow:hidden;margin-top:48px">
                    <div class="left">
                            <i>*</i>
                            <span>联系电话：</span>
                        </div>
                        <div style="float:left" class="num">
                            <input type="text" placeholder="">
                    </div>
            </div>
    </div>
    <div class="title">
        其他相关信息
    </div>
    <div class="commonwealInfo">
        <div class="left">
            <span>是否具有公益性质：</span>
        </div>
        <select name="commonweal" id="commonweal" style="width: 210px">
            <option value="">请选择</option>
        </select>
    </div>
    <div class="institutions">
        <div class="left">
            <span>直属机构：</span>
        </div>
        <input type="text" placeholder="" style="width: 338px">
    </div>
    <div class="banner">
        <div class="left">
            <i>*</i>
            <span>现场拍摄介绍图：</span>
        </div>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="img1" src="" alt="">
            </div>
            <input type="hidden" name="banner1" id="banner1" value="" />
            <input type="file" ref="avatarInput" name="banners1" id="banners1" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#banners1').on('change', function () {
                if (judge("banners1") == false) return false;
                ajaxFileUploads1();
            });

            function ajaxFileUploads1() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banners1', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        $("#banner1").val(data);
                        $("#img1").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banners1').change(function (e) { //再次绑定
                    ajaxFileUploads1();
                })
                return false;
            }
        </script>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="img2" src="" alt="">
            </div>
            <input type="hidden" name="banner2" id="banner2" value="" />
            <input type="file" ref="avatarInput" name="banners2" id="banners2" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#banners2').on('change', function () {
                if (judge("banners2") == false) return false;
                ajaxFileUploads2();
            });

            function ajaxFileUploads2() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banners2', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        $("#banner2").val(data);
                        $("#img2").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banners2').change(function (e) { //再次绑定
                    ajaxFileUploads2();
                })
                return false;
            }
        </script>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="img3" src="" alt="">
            </div>
            <input type="hidden" name="banner3" id="banner3" value="" />
            <input type="file" ref="avatarInput" name="banners3" id="banners3" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#banners3').on('change', function () {
                if (judge("banners3") == false) return false;
                ajaxFileUploads3();
            });

            function ajaxFileUploads3() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banners3', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        $("#banner3").val(data);
                        $("#img3").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banners3').change(function (e) { //再次绑定
                    ajaxFileUploads3();
                })
                return false;
            }

            function judge(str) {
                var max_size = 1024;
                var tmpFile = document.getElementById(str);
                var fileData = tmpFile.files[0];
                var size = fileData.size;
                if (size > max_size * 1024) {
                    alert("图片大小不能超过1M");
                    return false;
                } else {
                    return true;
                }
            }
        </script>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="img4" src="" alt="">
            </div>
            <input type="hidden" name="banner4" id="banner4" value="" />
            <input type="file" ref="avatarInput" name="banners4" id="banners4" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#banners4').on('change', function () {
                if (judge("banners4") == false) return false;
                ajaxFileUploads4();
            });

            function ajaxFileUploads4() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banners4', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        $("#banner4").val(data);
                        $("#img4").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banners4').change(function (e) { //再次绑定
                    ajaxFileUploads4();
                })
                return false;
            }

            function judge(str) {
                var max_size = 1024;
                var tmpFile = document.getElementById(str);
                var fileData = tmpFile.files[0];
                var size = fileData.size;
                if (size > max_size * 1024) {
                    alert("图片大小不能超过1M");
                    return false;
                } else {
                    return true;
                }
            }
        </script>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="img5" src="" alt="">
            </div>
            <input type="hidden" name="banner5" id="banner5" value="" />
            <input type="file" ref="avatarInput" name="banners5" id="banners5" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#banners5').on('change', function () {
                if (judge("banners5") == false) return false;
                ajaxFileUploads5();
            });

            function ajaxFileUploads5() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'banners5', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        $("#banner5").val(data);
                        $("#img5").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#banners5').change(function (e) { //再次绑定
                    ajaxFileUploads5();
                })
                return false;
            }

            function judge(str) {
                var max_size = 1024;
                var tmpFile = document.getElementById(str);
                var fileData = tmpFile.files[0];
                var size = fileData.size;
                if (size > max_size * 1024) {
                    alert("图片大小不能超过1M");
                    return false;
                } else {
                    return true;
                }
            }
        </script>
        <div class="tip" style="float:left">
            <div>(支持上传.jpg、.jpeg、.png格式图片</div>
            <div>图片比例为16:9且大小不能超过1M)</div>
        </div>
    </div>
    <div class="security_guarantee">
        <div class="left" style="width: 100px; margin-left: 32px">
            <span>资源单位设有配套相关的安全保障：</span>
        </div>
        <div class="example textarea2" style="margin-top: 10px">
            <span class="limit" style="display:inline-block">
                <textarea name="" id="" cols="72" rows="7" style="resize:none" maxlength="100" onchange="this.value=this.value.substring(0, 100)" onkeydown="this.value=this.value.substring(0, 100)"
                          onkeyup="this.value=this.value.substring(0, 100)"></textarea>
            </span>
        </div>
    </div>
    <div class="title">
        协议
    </div>
    <div class="banner">
        <div class="left" style="width: 100px; margin-left: 32px">
            <span>资源单位合作框架协议：</span>
        </div>
        <div class="pic pic1" style="float:left">
            <div class="file">
                <i></i>
                <img id="agreement_img" src="" alt="">
            </div>
            <input type="hidden" name="agreement" id="agreement" value="" />
            <input type="file" ref="avatarInput" name="agreement1" id="agreement1" accept="image/jpg,image/jpeg,image/png">
        </div>
        <script>
            $('#agreement1').on('change', function () {
                if (judge("agreement1") == false) return false;
                ajaxFileUploadsAgreement1();
            });

            function ajaxFileUploadsAgreement1() {
                $.ajaxFileUpload({
                    url: '<{:U("app/upload/uploadify",array("model"=>"goods","flag"=>3,"type"=>2))}>',
                    type: 'POST',
                    secureuri: false,
                    fileElementId: 'agreement1', //file标签的id
                    dataType: 'content', //返回数据的类型
                    success: function (data, status) {
                        console.log(data)
                        $("#agreement").val(data);
                        $("#agreement_img").attr('src', '__ROOT__/attachs/' + data).show();
                    },
                    error: function (data, status, e) {
                        alert(e);
                    }
                });
                $('#agreement1').change(function (e) { //再次绑定
                    ajaxFileUploadsAgreement1();
                })
                return false;
            }
        </script>
    </div>
    <script>
        $(function () {
            key('textarea1', 300)
            key('textarea2', 100)
            key('textarea3', 100)
            function key(name, num) {
                $('.' + name + ' textarea').on('keyup', function () {
                    if ($(this).val().length >= num - 20) {
                        $('.' + name + ' div').css('color', 'red')
                    } else {
                        $('.' + name + ' div').css('color', '#304B5D')
                    }
                    $('.' + name + ' i').text($(this).val().length)
                })
            }
        })
    </script>

    <div class="fixed">
        <button class="btn1">保存并提交审核</button>
        <button class="btn2">保存并预览</button>
    </div>
</form>
<include file='public:footer' />